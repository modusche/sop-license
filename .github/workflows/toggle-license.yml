name: Toggle License

  on:
    workflow_dispatch:
      inputs:
        action:
          description: 'License Action'
          required: true
          default: 'activate'
          type: choice
          options:
            - activate
            - kill
        message:
          description: 'Message to show (for kill action)'
          required: false
          default: 'License has been revoked.'

  jobs:
    toggle:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4

        - name: Update License
          run: |
            if [ "${{ github.event.inputs.action }}" == "kill" ]; then
              echo '{"status": "killed", "message": "${{ github.event.inputs.message }}"}' > license.json
            else
              echo '{"status": "active", "message": ""}' > license.json
            fi
            cat license.json

        - name: Commit changes
          run: |
            git config --local user.email "action@github.com"
            git config --local user.name "GitHub Action"
            git add license.json
            git commit -m "License ${{ github.event.inputs.action }}" || echo "No changes"
            git push
